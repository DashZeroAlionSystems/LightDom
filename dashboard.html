<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LightDom Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 10px;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .card h3 {
      margin-bottom: 15px;
      color: #333;
    }
    
    .metric {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }
    
    .metric:last-child {
      border-bottom: none;
    }
    
    .metric-value {
      font-weight: bold;
      color: #667eea;
    }
    
    .status-indicator {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }
    
    .status-healthy { background-color: #e8f5e8; color: #2d5a2d; }
    .status-pending { background-color: #fff3cd; color: #856404; }
    
    .button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    
    .button:hover {
      background: #5a67d8;
    }
    
    #log {
      background: #1a1a1a;
      color: #00ff00;
      padding: 15px;
      border-radius: 5px;
      height: 200px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üåü LightDom Blockchain Dashboard</h1>
      <p>DOM Space Optimization & Mining Platform</p>
    </div>
    
    <div class="dashboard">
      <div class="card">
        <h3>üè• System Health</h3>
        <div class="metric">
          <span>API Server</span>
          <span class="status-indicator status-healthy" id="api-status">Healthy</span>
        </div>
        <div class="metric">
          <span>Database</span>
          <span class="status-indicator status-pending" id="db-status">Pending</span>
        </div>
        <div class="metric">
          <span>Blockchain</span>
          <span class="status-indicator status-pending" id="blockchain-status">Pending</span>
        </div>
        <div class="metric">
          <span>Uptime</span>
          <span class="metric-value" id="uptime">0 seconds</span>
        </div>
      </div>
      
      <div class="card">
        <h3>‚õèÔ∏è Mining Statistics</h3>
        <div class="metric">
          <span>Active Miners</span>
          <span class="metric-value" id="active-miners">0</span>
        </div>
        <div class="metric">
          <span>Total Optimizations</span>
          <span class="metric-value" id="total-optimizations">0</span>
        </div>
        <div class="metric">
          <span>Space Saved</span>
          <span class="metric-value" id="space-saved">0 bytes</span>
        </div>
        <div class="metric">
          <span>DSH Tokens Mined</span>
          <span class="metric-value" id="dsh-tokens">0 DSH</span>
        </div>
      </div>
      
      <div class="card">
        <h3>‚õìÔ∏è Blockchain Status</h3>
        <div class="metric">
          <span>Network</span>
          <span class="metric-value" id="network">Local</span>
        </div>
        <div class="metric">
          <span>Block Height</span>
          <span class="metric-value" id="block-height">1</span>
        </div>
        <div class="metric">
          <span>Hash Rate</span>
          <span class="metric-value" id="hash-rate">0 H/s</span>
        </div>
        <div class="metric">
          <span>Last Block</span>
          <span class="metric-value" id="last-block">Just now</span>
        </div>
      </div>
      
      <div class="card">
        <h3>üéÆ Control Panel</h3>
        <button class="button" onclick="startMining()">Start Mining</button>
        <button class="button" onclick="stopMining()">Stop Mining</button>
        <button class="button" onclick="refreshData()">Refresh Data</button>
        <button class="button" onclick="clearLog()">Clear Log</button>
        
        <h4 style="margin-top: 20px;">System Log</h4>
        <div id="log"></div>
      </div>
    </div>
  </div>

  <script>
    let startTime = Date.now();
    
    function log(message) {
      const logElement = document.getElementById('log');
      const timestamp = new Date().toISOString().substr(11, 8);
      logElement.innerHTML += `[${timestamp}] ${message}\n`;
      logElement.scrollTop = logElement.scrollHeight;
    }
    
    function updateUptime() {
      const uptime = Math.floor((Date.now() - startTime) / 1000);
      document.getElementById('uptime').textContent = `${uptime} seconds`;
    }
    
    async function refreshData() {
      try {
        log('Fetching system metrics...');
        
        // Fetch health status
        const healthResponse = await fetch('http://localhost:3001/api/health');
        const health = await healthResponse.json();
        
        // Fetch metrics
        const metricsResponse = await fetch('http://localhost:3001/api/metrics');
        const metrics = await metricsResponse.json();
        
        // Fetch blockchain status
        const blockchainResponse = await fetch('http://localhost:3001/api/blockchain/status');
        const blockchain = await blockchainResponse.json();
        
        // Update UI
        document.getElementById('active-miners').textContent = metrics.activeMiners;
        document.getElementById('total-optimizations').textContent = metrics.totalOptimizations;
        document.getElementById('space-saved').textContent = `${metrics.spaceSaved} bytes`;
        document.getElementById('dsh-tokens').textContent = `${metrics.dshTokens} DSH`;
        
        document.getElementById('network').textContent = blockchain.network;
        document.getElementById('block-height').textContent = blockchain.blockHeight;
        document.getElementById('hash-rate').textContent = blockchain.hashRate;
        
        log('‚úÖ Data refreshed successfully');
      } catch (error) {
        log(`‚ùå Failed to fetch data: ${error.message}`);
      }
    }
    
    function startMining() {
      log('üöÄ Starting mining process...');
      // In a real implementation, this would call the API
      log('‚úÖ Mining started successfully');
    }
    
    function stopMining() {
      log('‚èπÔ∏è Stopping mining process...');
      log('‚úÖ Mining stopped');
    }
    
    function clearLog() {
      document.getElementById('log').innerHTML = '';
    }
    
    // Initialize dashboard
    log('üåü LightDom Dashboard initialized');
    log('üîó Connecting to API server...');
    
    // Update uptime every second
    setInterval(updateUptime, 1000);
    
    // Refresh data every 30 seconds
    setInterval(refreshData, 30000);
    
    // Initial data load
    refreshData();
  </script>
</body>
</html>
